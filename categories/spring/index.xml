<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Spring on Laelaps</title>
    <link>https://blog.laelaps.us/categories/spring/</link>
    <description>Recent content in Spring on Laelaps</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 07 Sep 2023 08:51:44 +0800</lastBuildDate>
    <atom:link href="https://blog.laelaps.us/categories/spring/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Spring MVC æ‹¦æˆªå™¨</title>
      <link>https://blog.laelaps.us/posts/spring/mvc/handlerinterceptor/</link>
      <pubDate>Thu, 07 Sep 2023 08:51:44 +0800</pubDate>
      <guid>https://blog.laelaps.us/posts/spring/mvc/handlerinterceptor/</guid>
      <description>è¿‡æ»¤å™¨vsæ‹¦æˆªå™¨ è¿‡æ»¤å™¨ï¼ˆFilterï¼‰æ˜¯Servletçš„ç‰¹æ€§ï¼Œä»–å±äºServletå®¹å™¨ï¼›è€Œæ‹¦æˆªå™¨ï¼ˆHandlerInterceptorï¼‰æ˜¯ç”±Spring MVCæä¾›çš„ç‰¹æ€§ã€‚ Filterå¯ä»¥æ‹¦æˆªæ‰€åˆ°è¾¾çš„æ‰€æœ‰è¯·æ±‚ï¼Œè€ŒHandlerInterceptoråªèƒ½æ‹¦æˆªè¢«DispatcherServletå¤„ç†è¿‡çš„è¯·æ±‚ã€‚ åœ¨Requeståˆ°è¾¾Servletä¹‹å‰å…ˆæ‰§è¡ŒFilterçš„é¢„å¤„ç†é€»è¾‘ï¼Œåœ¨Requeståˆ°è¾¾DispatcherServletä¹‹åï¼ŒHandleræ‰§è¡Œä¹‹å‰æ‰§è¡Œæ‹¦æˆªå™¨çš„åŠŸèƒ½ã€‚ Filteråœ¨doFilteræ–¹æ³•ä¸­å®šä¹‰é¢„å¤„ç†å’Œåå¤„ç†ä¸¤ä¸ªé€»è¾‘ï¼Œä¹‹é—´ä½¿ç”¨filterChain.doFilterè¿›è¡Œåˆ†éš”ï¼ŒåŒæ—¶Filterè‡ªèº«æœ‰åˆå§‹åŒ–å’Œé”€æ¯çš„æ–¹æ³•ï¼Œå³initå’Œdestroyï¼›è€ŒHandlerIntercepteråˆ™æ˜¯å°†è¿™ä¸¤ä¸ªæ–¹å¼åˆ†å¼€preHandleã€postHandleä¸¤ä¸ªæ–¹æ³•ï¼ŒåŒæ—¶ä»–æ‹¥æœ‰ä¸€ä¸ªafterCompletionæ–¹æ³•ï¼Œæ— è®ºæœ‰æ²¡æœ‰å‘ç”Ÿå¼‚å¸¸ï¼Œåœ¨DispatchServletä¹‹åï¼Œéƒ½ä¼šæ‰§è¡ŒafterCompletionã€‚ å¦‚æœåœ¨Springä¸­ä½¿ç”¨HandlerInterceptorå¯ä»¥è‡ªåŠ¨Springå®¹å™¨ä¸­è¢«ç®¡ç†ã€‚ åŸç† åœ¨HandlerMappingåœ¨æ ¹æ®RequestæŸ¥æ‰¾Handleræ—¶ï¼Œä»–ä¼šè¿”å›ä¸€ä¸ªå¤„ç†å™¨æ‰§è¡Œé“¾å¯¹è±¡ï¼ˆHandlerExecutionChainï¼‰ï¼Œå†…éƒ¨åŒ…å«äº†ä¸€ä¸ªHandlerå’ŒHandlerInterceptoræ‰§è¡Œé“¾ã€‚å¦‚æœæƒ³è¦è‡ªå®šä¹‰Handleræ‹¦æˆªå™¨ï¼Œé‚£ä¹ˆéœ€è¦å®ç°HandlerInterceptoræ¥å£ä¸­çš„ä¸‰ä¸ªæ–¹æ³•ã€‚
preHandleï¼šåœ¨å¤„ç†Handlerä¹‹å‰æ‰§è¡Œã€‚ postHandleï¼šåœ¨å¤„ç†HandleræˆåŠŸä¹‹åï¼Œæ ¹æ®æ‰§è¡Œé“¾çš„å€’åºæ‰§è¡Œï¼Œå¦‚æœå‰é¢çš„æµç¨‹å‡ºç°å¼‚å¸¸åˆ™ä¸ä¼šè¢«æ‰§è¡Œã€‚ afterCompletionï¼šåœ¨è¯·æ±‚æ‰§è¡Œå®Œä¹‹åæ‰§è¡Œï¼Œä»–ä¹‹åå¯¹preHandleè¿”å›Trueçš„HandlerInterceptoræ‰§è¡Œã€‚ preHandle preHandleè¿”å›ä¸€ä¸ªboolç±»å‹çš„å€¼ï¼Œå¯ä»¥ç”¨æ¥ç»ˆç«¯æˆ–ç»§ç»­å¤„ç†æ‰§è¡Œé“¾ã€‚å¦‚æœæ–¹æ³•è¿”å›Trueæ—¶ï¼Œä»–ä¼šç»§ç»­æ²¿ç€æ‰§è¡Œé“¾ç»§ç»­å‘åæ‰§è¡Œï¼›å¦‚æœè¿”å›falseï¼ŒDispatcherServlet ä¼šå‡å®šæ‹¦æˆªå™¨æœ¬èº«å·²å¤„ç†å®Œæ¯•è¯·æ±‚ï¼ˆä¾‹å¦‚ï¼Œå·²ç»æ¸²æŸ“äº†åˆé€‚çš„è§†å›¾ï¼‰ï¼Œæ­¤æ—¶å°†å°è¯•ç›´æ¥å€’åºæ‰§è¡Œæ­¤å‰å·²æ”¾è¡Œçš„æ‹¦æˆªå™¨é“¾çš„afterCompletion æ–¹æ³•ã€‚
å¤šä¸ªæ‹¦æˆªå™¨ æˆ‘ä»¬åœ¨MVCçš„é…ç½®ä¸­å¯ä»¥é…ç½®å¤šä¸ªæ‹¦æˆªå™¨ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯é€šè¿‡é…ç½®çš„é¡ºåºæ¥æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨InterceptorRegistrationçš„Orderå±æ€§æ¥å®šä¹‰ä¼˜å…ˆçº§é—®é¢˜ï¼Œorderä¸­çš„å€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ã€‚
Example å®šä¹‰ä¸€ä¸ªå®ç°äº†HandlerInterceptoræ¥å£çš„æ‹¦æˆªå™¨ã€‚
@Component public class MyHandlerInterceptor implements HandlerInterceptor { @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(&amp;#34;MyHandlerInterceptor preHandle method......&amp;#34;); return HandlerInterceptor.super.preHandle(request, response, handler); } @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { HandlerInterceptor.super.postHandle(request, response, handler, modelAndView); System.out.println(&amp;#34;MyHandlerInterceptor postHandle method......&amp;#34;); } @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { HandlerInterceptor.</description>
    </item>
    <item>
      <title>Spring Boot ç›‘å¬äº‹ä»¶</title>
      <link>https://blog.laelaps.us/posts/spring/boot/applicationevent/</link>
      <pubDate>Tue, 05 Sep 2023 13:46:42 +0800</pubDate>
      <guid>https://blog.laelaps.us/posts/spring/boot/applicationevent/</guid>
      <description>äº‹ä»¶ç›‘å¬ Springä¸­çš„äº‹ä»¶ç›‘å¬æ˜¯è§‚å¯Ÿè€…æ¨¡å¼çš„ä¸€ç§å®ç°ï¼Œåœ¨è§‚å¯Ÿè€…æ¨¡å¼å½“ä¸­ï¼Œåº”å½“æœ‰ä¸»é¢˜ã€å‘å¸ƒè€…ã€è®¢é˜…äººï¼›æ‰€æœ‰åœ¨Springçš„äº‹ä»¶ä¸­å­˜åœ¨äº‹ä»¶ï¼ˆApplicationEventï¼‰ã€ç›‘å¬å™¨ï¼ˆApplicationListenerï¼‰å’Œäº‹ä»¶å‘å¸ƒä¸‰éƒ¨åˆ†ã€‚
äº‹ä»¶ç”¨äºåœ¨æ¾è€¦åˆçš„ç»„ä»¶ä¹‹é—´äº¤æ¢ä¿¡æ¯ï¼Œå‘å¸ƒè€…å’Œè®¢é˜…è€…ä¹‹é—´æ²¡æœ‰ç›´æ¥è€¦åˆï¼Œä½¿å¾—ä¿®æ”¹å‘å¸ƒè€…å¹¶ä¸ä¼šå½±å“è®¢é˜…è€…ï¼Œåä¹‹ä¹Ÿæˆç«‹ã€‚
ç›‘å¬äº‹ä»¶ ç›‘å¬äº‹ä»¶æ˜¯æ¶ˆæ¯ä¼ é€’çš„å¯¹è±¡ï¼Œç”¨æ¥ä¼ é€’äº‹ä»¶æ¶ˆæ¯ï¼Œåœ¨Springä¸­æˆ‘ä»¬å»ç»§æ‰¿ApplicationEventæ¥å®šä¹‰ä¸€ä¸ªäº‹ä»¶ã€‚
public class MyEvent extends ApplicationEvent { private String name; private int age; public MyEvent(Object source, String name, int age) { super(source); this.age = age; this.name = name; } } äº‹ä»¶å‘å¸ƒ åœ¨å®šä¹‰äº‹ä»¶åï¼Œæˆ‘ä»¬éœ€è¦å‘å¸ƒäº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ApplicationContextå’ŒApplicationEventPublisherä¸¤è€…æ¥å‘å¸ƒäº‹ä»¶ï¼›å‰è€…å»ç»§æ‰¿äº†åè€…ã€‚
@Service public class MyEventService { @Autowired ApplicationContext applicationContext; @Autowired ApplicationEventPublisher applicationEventPublisher; public void myEvent(){ System.out.println(&amp;#34;å‘å¸ƒäº‹ä»¶......&amp;#34;); applicationContext.publishEvent(new MyEvent(this, &amp;#34;laelaps&amp;#34;, 12)); System.out.println(&amp;#34;äº‹ä»¶å‘å¸ƒå®Œæ¯•ã€‚&amp;#34;); } public void myEvent2(){ System.out.println(&amp;#34;å‘å¸ƒäº‹ä»¶......&amp;#34;); applicationEventPublisher.publishEvent(new MyEvent(this, &amp;#34;laelaps&amp;#34;, 12)); System.out.println(&amp;#34;äº‹ä»¶å‘å¸ƒå®Œæ¯•ã€‚&amp;#34;); } } äº‹ä»¶ç›‘å¬ åœ¨å‘å¸ƒäº†äº‹ä»¶åï¼Œæˆ‘ä»¬éœ€è¦ç›‘å¬è€…å»ç›‘å¬å‘å¸ƒçš„äº‹ä»¶ï¼›åœ¨Springä¸­æœ‰ä¸¤ç§æ–¹å¼æ¥å®šä¹‰ç›‘å¬å¯¹è±¡ï¼›</description>
    </item>
  </channel>
</rss>
